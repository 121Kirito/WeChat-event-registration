<!-- profile.wxml - 个人中心页面 -->
<view class="container">
  <!-- 用户信息头部 -->
  <view class="user-header">
    <!-- 背景 -->
    <view class="header-bg"></view>

    <!-- 用户信息 -->
    <view class="user-info">
      <view class="avatar-container">
        <image class="user-avatar" src="{{userInfo.avatar}}" mode="aspectFill" binderror="onImageError"></image>
        <view class="avatar-badge">VIP</view>
      </view>

      <view class="user-details">
        <view class="user-name-row">
          <text class="user-name">{{userInfo.name || '未设置昵称'}}</text>
          <view class="user-level">Lv.{{userStats.level || 1}}</view>
        </view>
        <text class="user-bio">{{userInfo.bio || '这个人很懒，什么都没有留下'}}</text>
        <view class="user-meta">
          <text class="user-id">ID: {{userInfo.id}}</text>
          <text class="user-join-time">{{userInfo.joinTime}}</text>
        </view>
      </view>

      <button class="edit-btn" bindtap="onEditProfile">
        <text class="edit-icon">✏️</text>
      </button>
    </view>
  </view>

  <!-- 统计信息卡片 -->
  <view class="stats-card">
    <view class="stats-header">
      <text class="stats-title">我的数据</text>
    </view>
    <view class="stats-grid">
      <view class="stat-item" bindtap="onViewMyActivities">
        <view class="stat-icon">📊</view>
        <text class="stat-number">{{userStats.totalActivities || 0}}</text>
        <text class="stat-label">参与活动</text>
      </view>
      <view class="stat-item" bindtap="onViewCompletedActivities">
        <view class="stat-icon">✅</view>
        <text class="stat-number">{{userStats.completedActivities || 0}}</text>
        <text class="stat-label">已完成</text>
      </view>
      <view class="stat-item" bindtap="onViewUpcomingActivities">
        <view class="stat-icon">⏰</view>
        <text class="stat-number">{{userStats.upcomingActivities || 0}}</text>
        <text class="stat-label">即将开始</text>
      </view>
      <view class="stat-item" bindtap="onViewFavorites">
        <view class="stat-icon">❤️</view>
        <text class="stat-number">{{userStats.favoriteActivities || 0}}</text>
        <text class="stat-label">收藏活动</text>
      </view>
    </view>
  </view>

  <!-- 快捷功能 -->
  <view class="quick-actions">
    <view class="action-item" bindtap="onCreateActivity">
      <view class="action-icon create">➕</view>
      <text class="action-text">发布活动</text>
    </view>
    <view class="action-item" bindtap="onViewMyActivities">
      <view class="action-icon my">📋</view>
      <text class="action-text">我的活动</text>
    </view>
    <view class="action-item" bindtap="onViewFavorites">
      <view class="action-icon favorite">❤️</view>
      <text class="action-text">收藏</text>
    </view>
    <view class="action-item" bindtap="onViewHistory">
      <view class="action-icon history">🕒</view>
      <text class="action-text">历史</text>
    </view>
  </view>
  <!-- 功能菜单 -->
  <view class="menu-section">
    <view class="menu-group">
      <view class="group-title">活动管理</view>
      <view class="menu-item" bindtap="onManageActivities">
        <view class="menu-icon-wrapper">
          <text class="menu-icon">⚙️</text>
        </view>
        <view class="menu-content">
          <text class="menu-text">管理我的活动</text>
          <text class="menu-desc">管理已发布的活动</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>
    </view>

    <view class="menu-group">
      <view class="group-title">设置与帮助</view>
      <view class="menu-item" bindtap="onSettings">
        <view class="menu-icon-wrapper">
          <text class="menu-icon">🔧</text>
        </view>
        <view class="menu-content">
          <text class="menu-text">设置</text>
          <text class="menu-desc">个性化设置</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>

      <view class="menu-item" bindtap="onHelp">
        <view class="menu-icon-wrapper">
          <text class="menu-icon">❓</text>
        </view>
        <view class="menu-content">
          <text class="menu-text">帮助与反馈</text>
          <text class="menu-desc">获取帮助或反馈问题</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>

      <view class="menu-item" bindtap="onAbout">
        <view class="menu-icon-wrapper">
          <text class="menu-icon">ℹ️</text>
        </view>
        <view class="menu-content">
          <text class="menu-text">关于我们</text>
          <text class="menu-desc">了解应用信息</text>
        </view>
        <text class="menu-arrow">›</text>
      </view>
    </view>
  </view>

  <!-- 退出登录 -->
  <view class="logout-section">
    <button class="logout-btn" bindtap="onLogout">退出登录</button>
  </view>
</view>

<!-- 编辑资料弹窗 -->
<view class="modal-overlay" wx:if="{{showEditModal}}" bindtap="onCloseEditModal">
  <view class="modal-content" catchtap="stopPropagation">
    <view class="modal-header">
      <text class="modal-title">编辑资料</text>
      <text class="close-btn" bindtap="onCloseEditModal">✕</text>
    </view>

    <view class="modal-body">
      <view class="form-section">
        <view class="form-item">
          <text class="form-label">头像</text>
          <view class="avatar-upload" bindtap="onChooseAvatar">
            <image class="upload-avatar" src="{{editUserInfo.avatar}}" mode="aspectFill"></image>
            <view class="upload-overlay">
              <text class="upload-text">点击更换</text>
            </view>
          </view>
        </view>

        <view class="form-item">
          <text class="form-label">昵称</text>
          <input class="form-input" placeholder="请输入昵称" value="{{editUserInfo.name}}" bindinput="onNameInput" />
        </view>

        <view class="form-item">
          <text class="form-label">手机号</text>
          <input class="form-input" placeholder="请输入手机号" value="{{editUserInfo.phone}}" bindinput="onPhoneInput" />
        </view>

        <view class="form-item">
          <text class="form-label">邮箱</text>
          <input class="form-input" placeholder="请输入邮箱" value="{{editUserInfo.email}}" bindinput="onEmailInput" />
        </view>

        <view class="form-item">
          <text class="form-label">个人简介</text>
          <textarea class="form-textarea" placeholder="介绍一下自己吧..." value="{{editUserInfo.bio}}" bindinput="onBioInput"></textarea>
        </view>
      </view>
    </view>

    <view class="modal-footer">
      <button class="cancel-btn" bindtap="onCloseEditModal">取消</button>
      <button class="confirm-btn" bindtap="onSaveProfile">保存</button>
    </view>
  </view>
</view>
